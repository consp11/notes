# Last Modified: Fri Dec 15 13:19:41 2023
abi <abi/3.0>,

include <tunables/global>

/home/main/users/tor-browser/bin/tor-browser/Browser/start-tor-browser {
  include <abstractions/base>

  capability sys_admin,
  capability sys_chroot,
  capability sys_ptrace,

  network inet dgram,
  network inet stream,
  network inet6 dgram,
  network inet6 stream,
  network netlink raw,

  dbus,

  signal send set=kill peer=/home/main/users/tor-browser/bin/tor-browser/Browser/TorBrowser/Tor/PluggableTransports/lyrebird,
  signal send set=term peer=/home/main/users/tor-browser/bin/tor-browser/Browser/TorBrowser/Tor/PluggableTransports/lyrebird,

  unix,

  / r,
  /dev/ r,
  /dev/dri/ r,
  /dev/shm/ r,
  /dev/tty rw,
  /etc/** r,
  /etc/**/ r,
  /home/main/users/tor-browser/** mrwk,
  /home/main/users/tor-browser/bin/tor-browser/Browser/TorBrowser/Tor/PluggableTransports/lyrebird px,
  /home/main/users/tor-browser/bin/tor-browser/Browser/TorBrowser/Tor/tor px,
  /home/main/users/tor-browser/bin/tor-browser/Browser/abicheck ix,
  /home/main/users/tor-browser/bin/tor-browser/Browser/firefox ix,
  /home/main/users/tor-browser/bin/tor-browser/Browser/firefox.real ix,
  /home/main/users/tor-browser/bin/tor-browser/Browser/glxtest mrix,
  /home/main/users/tor-browser/bin/tor-browser/Browser/start-tor-browser r,
  /home/main/users/tor-browser/bin/tor-browser/Browser/updater mrix,
  /home/main/users/tor-browser/bin/tor-browser/Browser/vaapitest mrix,
  /inRamA/ r,
  /inRamA/** rw,
  /proc/sys/dev/i915/perf_stream_paranoid r,
  /proc/sys/kernel/random/* r,
  /proc/sys/net/core/somaxconn r,
  /run/dbus/system_bus_socket rw,
  /run/systemd/resolve/stub-resolv.conf r,
  /run/udev/data/+input:input[0-9] r,
  /run/udev/data/+input:input[0-9][0-9] r,
  /run/udev/data/c13:[0-9][0-9] r,
  /sys/bus/ r,
  /sys/bus/pci/devices/ r,
  /sys/class/ r,
  /sys/class/input/ r,
  /sys/devices/**/input/input[0-9]/uevent r,
  /sys/devices/*/*/ r,
  /sys/devices/*/*/drm/ r,
  /sys/devices/*/*/drm/card[0-9]/ r,
  /sys/devices/*/*/drm/renderD128/ r,
  /sys/devices/*/*/revision r,
  /sys/devices/*/*/sound/card[0-9]/input[0-9]/event[0-9]/uevent r,
  /sys/devices/*/*/sound/card[0-9]/input[0-9]/uevent r,
  /sys/devices/*/*/{device,subsystem_device,class,vendor,subsystem_vendor,uevent} r,
  /sys/devices/LNXSYSTM*/**/uevent r,
  /sys/devices/pci*/**/uevent r,
  /sys/devices/system/cpu/cpu[0-9]/cache/index[0-9]/size r,
  /sys/devices/system/cpu/cpufreq/policy[0-9]/cpuinfo_max_freq r,
  /sys/devices/system/cpu/present r,
  /sys/devices/system/node/node[0-9]/meminfo r,
  /sys/devices/virtual/input/mice/uevent r,
  /sys/kernel/mm/transparent_hugepage/hpage_pmd_size r,
  /usr/bin/bash mrix,
  /usr/bin/cp mrix,
  /usr/bin/dirname mrix,
  /usr/bin/env mix,
  /usr/bin/expr mrix,
  /usr/bin/file mrix,
  /usr/bin/getconf mrix,
  /usr/bin/grep mrix,
  /usr/bin/id mrix,
  /usr/bin/ln mrix,
  /usr/bin/mkdir mrix,
  /usr/bin/rm mrix,
  /usr/bin/sed mrix,
  /usr/bin/zenity mrix,
  /usr/libexec/** mr,
  /usr/local/share/fonts/ r,
  /usr/local/share/fonts/** r,
  /usr/share/** r,
  /usr/share/**/ r,
  /var/cache/fontconfig/ w,
  /var/cache/fontconfig/* r,
  /var/lib/flatpak/exports/share/** r,
  /var/lib/flatpak/exports/share/**/ r,
  owner /dev/shm/* rw,
  owner /home/main/users/tor-browser/** mrwlk,
  owner /proc/** rwk,
  owner /tmp/** rwk,
  owner /tmp/**/ rwk,

}
